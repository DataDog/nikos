---
- name: Prepare
  hosts: all
  tasks:
  - name: Enable Repos
    shell: 'yum-config-manager --enable amzn2extra-docker && yum-config-manager --enable amzn2-core'
    become: true

  - name: Install Docker
    shell: 'yum install docker'
    become: true

  - name: Install pip
    package:
      name: python3-pip
      lock_timeout: 180
    become: true

  - name: Install docker-py
    shell: 'pip3 install docker'
    become: true

  - name: Start docker
    service:
      name: docker
      state: started
    become: true
