---
- name: get path to downloaded headers
  shell: |
    kern_version=$(uname -r)
    header_path=usr/src/linux-headers-$(uname -r)/arch/x86/include/generated/uapi/asm/types.h
    echo $header_path
  register: header_path

- name: stat "/tmp/result/{{ header_path.stdout }}"
  stat:
    path: "/tmp/result/{{ header_path.stdout }}"
  register: stat_result

- name: check kernel headers were successfully unpacked
  assert:
    that: stat_result.stat.exists